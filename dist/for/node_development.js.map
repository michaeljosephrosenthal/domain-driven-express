{"version":3,"sources":["webpack:///webpack/bootstrap 75ac059b7ccaddaa73cb","webpack:///external \"express\"","webpack:///./src/domainMiddlewareGenerator.js","webpack:///./src/index.js","webpack:///./src/server.js","webpack:///external \"strictduck-domain-driven-fullstack\""],"names":[],"mappings":"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","file":"node_development.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 75ac059b7ccaddaa73cb\n **/","module.exports = require(\"express\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express\"\n ** module id = 1\n ** module chunks = 0\n **/","import express from 'express'\n\nfunction filterDomainsForType(domains, type){\n    return Object.keys(domains)\n        .map(k => domains[k])\n        .filter(domain => Object.keys(domain.get(type)).length)\n}\n\nfunction routeBuilder({router, routes, order, prefix=''}) {\n  let keys = order || Object.keys(routes)\n  keys.forEach(endpoint => {\n     var {methods, handlers} = routes[endpoint];\n     methods.forEach(method => {\n       router[method](prefix+endpoint, ...handlers);\n     });\n  });\n  return router;\n};\n\nfunction domainRoutes({prefix, routes, order}){\n    return routeBuilder({router: express.Router(), routes, order, prefix: `/${prefix}`})\n}\n\n\nfunction genericMiddlewareFlattener(domains){\n    return filterDomainsForType(domains, 'middleware')\n        .reduce((list, domain) => [...list, ...domain.get('middleware')], [])\n        .filter(middleware => typeof(middleware) == 'function')\n}\n\nexport function domainRouteMiddlewareGenerator(domains){\n    return filterDomainsForType(domains, 'routes').map(domainRoutes)\n}\n\nexport function genericDomainMiddlewareGenerator(domains){\n    return genericMiddlewareFlattener(domains)\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/domainMiddlewareGenerator.js\n **/","const server = ($ES.CONTEXT == 'NODE' ? require('./server') : require('./representation')).default\nexport default server\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","import express from 'express'\nimport { server as ddServer, storePersistencePlugin } from 'strictduck-domain-driven-fullstack'\nimport { genericDomainMiddlewareGenerator, domainRouteMiddlewareGenerator } from './domainMiddlewareGenerator'\n\nexport default ddServer.implement({\n    name: 'DomainDrivenExpress',\n    constructor({\n        Domains: domains,\n        DomainDrivenStorePersistencePlugin : persister,\n        middlewareGenerators=[ genericDomainMiddlewareGenerator, domainRouteMiddlewareGenerator ],\n        server=express(),\n        container,\n    }){\n        if(!(persister instanceof Error)){\n            persister.provide(domains)\n            domains = persister.provideInjectionForDomainRouteHandlers(domains)\n        }\n\n        server._domains = server._domains || {}\n        server.generateMiddleware = function(domains){\n            middlewareGenerators.forEach(\n                generator => generator(domains).forEach(\n                    middleware => this.use(middleware)\n                )\n            )\n            Object.assign(this._domains, domains)\n        }\n        server.generateMiddleware.bind(server)(domains)\n        return [server]\n    },\n    provider({ port=3000, DomainDrivenClient: client }){\n        if(client){\n            this.generateMiddleware.bind(this)({'': client.provide()})\n        }\n\n        let app = express()\n        app.use(this)\n        app.listen(port, error => {\n            if (error) {\n                console.error(error)\n            } else {\n                console.info(`==> Listening on port ${port}. Open up http://localhost:${port}/ in your browser.`)\n            }\n        })\n    }\n})\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server.js\n **/","module.exports = require(\"strictduck-domain-driven-fullstack\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"strictduck-domain-driven-fullstack\"\n ** module id = 5\n ** module chunks = 0\n **/"],"sourceRoot":""}